!function(t){function e(a){if(r[a])return r[a].exports;var n=r[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var r={};e.m=t,e.c=r,e.i=function(t){return t},e.d=function(t,r,a){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:a})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=3)}([function(t,e,r){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}(),i=function(){function t(e){a(this,t),this.app=e,this.searching=!1;var r=$.get("/airlines");$.when(r).done(function(t){this.airlines=t}.bind(this))}return n(t,[{key:"makeAPICalls",value:function(t,e){var r=this.airlines.length,a=moment($("#flight-date").datetimepicker("viewDate")).format("YYYY-MM-DD"),n=[];if(moment(t.date)>=moment().subtract(1,"day")){e.html('\n      <img\n        src="img/loader.gif"\n        class="loader-img"\n      />');for(var i=0;i<this.airlines.length;i+=1)$.getJSON("/flight_search/"+this.airlines[i].code+"?date="+t.date+"&from="+t.from+"&to="+t.to,function(t){for(var i=0;i<t.length;i+=1)n.push(t[i]);0===(r-=1)&&(this.app.results.renderResults(a,n,e),$("#btn-search-flight").removeAttr("disabled"),this.searching=!1)}.bind(this))}else e.html('<p class="tab-para">Sorry. Can not search flights dates in the past</p>')}},{key:"searchFlights",value:function(){if(!this.searching){this.searching=!0,this.app.results.hideTabs(),this.app.results.showLoader(),$("#btn-search-flight").attr("disabled","disabled");var t=$("#input-airport-from").val().substr(1,3),e=$("#input-airport-to").val().substr(1,3),r=moment($("#flight-date").datetimepicker("viewDate")).format("YYYY-MM-DD");this.makeAPICalls({from:t,to:e,date:r},$("#date3")),this.makeAPICalls({from:t,to:e,date:moment(r).subtract(2,"days").format("YYYY-MM-DD")},$("#date1")),this.makeAPICalls({from:t,to:e,date:moment(r).subtract(1,"days").format("YYYY-MM-DD")},$("#date2")),this.makeAPICalls({from:t,to:e,date:moment(r).add(1,"days").format("YYYY-MM-DD")},$("#date4")),this.makeAPICalls({from:t,to:e,date:moment(r).add(2,"days").format("YYYY-MM-DD")},$("#date5"))}}},{key:"getQuery",value:function(){return{from:$("#input-airport-from").val().substr(1,3),to:$("#input-airport-to").val().substr(1,3),date:$("#flight-date").val()}}}]),t}();e.default=i},function(t,e,r){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}(),i=function(){function t(e){a(this,t),this.app=e,this.setupTypeaheads(),this.setupDatepicker(),this.setupFormSubmit(),$("#input-airport-from").focus()}return n(t,[{key:"setupTypeaheads",value:function(){$("#input-airport-from").typeahead({onSelect:function(){$("#input-airport-to").focus()},ajax:{url:"/airports?q="+$("#input-airport-from").val(),timeout:500,displayField:"displayField",valueField:"airportCode",triggerLength:3,items:25,method:"GET"}}),$("#input-airport-from").change(function(){this.validateFromAirport()}.bind(this)),$("#input-airport-to").typeahead({onSelect:function(){$("#flight-date").focus()},ajax:{url:"/airports?q="+$("#input-airport-from").val(),timeout:500,displayField:"displayField",valueField:"airportCode",triggerLength:2,method:"GET"}}),$("#input-airport-to").change(function(){this.validateToAirport()}.bind(this))}},{key:"setupDatepicker",value:function(){var t=new Date,e=new Date(t.getFullYear(),t.getMonth(),t.getDate());$("#flight-date").datetimepicker({format:"Do MMMM YYYY",minDate:e}),$("#flight-date").on("dp.hide",function(){$("#btn-search-flight").focus()})}},{key:"setupFormSubmit",value:function(){document.onkeydown=function(){return"13"!==window.event.keyCode||(this.submitForm(),!1)}.bind(this),$("#flight-search-form").on("submit",function(){return this.submitForm(),!1}.bind(this))}},{key:"validateFromAirport",value:function(){var t=!0;return"("===$("#input-airport-from").val()[0]&&")"===$("#input-airport-from").val()[4]?$("#input-airport-from").removeClass("input-error"):(t=!1,$("#input-airport-from").addClass("input-error")),t}},{key:"validateToAirport",value:function(){var t=!0;return"("===$("#input-airport-to").val()[0]&&")"===$("#input-airport-to").val()[4]?$("#input-airport-to").removeClass("input-error"):(t=!1,$("#input-airport-to").addClass("input-error")),t}},{key:"validateDate",value:function(){var t=!0;return""===$("#flight-date").val()?(t=!1,$("#flight-date").addClass("input-error")):$("#flight-date").removeClass("input-error"),t}},{key:"submitForm",value:function(){return this.validateFromAirport()&&this.validateToAirport()&&this.validateDate()&&this.app.api.searchFlights(),!1}}]),t}();e.default=i},function(t,e,r){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var r=0;r<e.length;r++){var a=e[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,r,a){return r&&t(e.prototype,r),a&&t(e,a),e}}(),i=function(){function t(e){a(this,t),this.app=e,this.hideResults()}return n(t,[{key:"hideResults",value:function(){$("#loader").hide(),$("#tabs").hide(),$("#results").css("visibility","visible")}},{key:"sortByPrice",value:function(t){return t.sort(function(t,e){return t.price-e.price}),t}},{key:"renderResults",value:function(t,e,r){var a=this.sortByPrice(e);$("#date1-label").html(moment(t).subtract(2,"days").format("Do MMMM YYYY")),$("#date2-label").html(moment(t).subtract(1,"days").format("Do MMMM YYYY")),$("#date3-label").html(moment(t).format("Do MMMM YYYY")),$("#date4-label").html(moment(t).add(1,"days").format("Do MMMM YYYY")),$("#date5-label").html(moment(t).add(2,"days").format("Do MMMM YYYY"));for(var n="",i=0;i<a.length;i+=1)n+="\n      <tr>\n        <td><strong>$"+a[i].price+"</strong></td>\n        <td>"+moment(a[i].start.dateTime).format("Do MMMM YYYY h:mm a")+"</td>\n        <td>"+a[i].airline.name+" "+a[i].airline.code+" "+a[i].flightNum+"</td>\n        <td>"+a[i].plane.shortName+'</td>\n        <td><button class="btn btn-sm btn-success pull-right">Book Flight</button></td>\n      </tr>\n      ';var o='\n    <p class="tab-para">(sorted by price ascending)</p>\n      <table class="table table-hover table-condensed table-striped">\n        <tbody>\n          '+n+"\n        </tbody>\n      </table>\n    ";r.html(o),this.hideLoader(),this.showTabs()}},{key:"showLoader",value:function(){$("#loader").show()}},{key:"showTabs",value:function(){$("#tabs").show()}},{key:"hideLoader",value:function(){$("#loader").hide()}},{key:"hideTabs",value:function(){$("#tabs").hide()}}]),t}();e.default=i},function(t,e,r){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}var n=r(0),i=a(n),o=r(1),s=a(o),u=r(2),l=a(u);$(document).ready(function(){var t={};t.api=new i.default(t),t.results=new l.default(t),t.inputControls=new s.default(t)})}]);